# 1 Добавление строго типизированного класса документа

Мы зависимы с двух сторон, делаем гет запрос сущности документа,получаем жсон,работаем непосредственно с этой структурой и после преобразовываем его в xml через xslt с макросами(если сущность != "" то не добавляем в xml) для дальнейшей отправки.

Работа над этой сущносью явно должна быть через класс. Да постоянные новые требования о добавлении изменении и избавлении атрибутов есть, но работа с кодом в будущем будет намного легче.

# 2 Неразбериха с табуляцией и целостность данных и прослойка подготовки отправки
1с отдает нам информацию, используя escape-символы, мы же при принятии этой информации сразу преобразовываем в наш формат (Regex.Unescape), сохраняем в бд и работаем с ней в дальнейшем.
Баг был именно в этом, 1с отправлял с escape-символами, и рассчитывает принимать их в ответ от нас, было больно это выявлять.
Решили сохранять ответ в нетронутом виде и добавили прослойку подготовки к отправке ответа в случае необходимости.

# 3 Конфигурация проекта
Вытащил в отдельный конфигурационный файл ключи, которые повторялись и в бд и в appsettings.json и в appsettings.local.json.
Была путаница с порядком билда configuration объекта.
Теперь все общие ключи в 1 файле, и не надо перепроверять в нескольких местах, где кто кого перетирает.
# 4 Локальные xslt
избавился от логики получения xslt шаблонов документов непосредственно из проекта, работа теперь только через файловый сервис, а гуид документа находится в конфигурационном файле, таким образом не будет путаницы в локальной отладке, когда мы вроде запустили бизнес процесс, он отработал, залили на прод, а там не смаппились аттрибуты из одного расширения в другой.

# 5 Background Services
В планах включить настройку по отключению/включению всех шедулеров, поскольку сейчас висит техдолг на их локальную отладку. В данный момент мы руками прописываем в начале выполнения шедулера return, чтобы он не стучался к той базе, к которой локально нет доступа:)
